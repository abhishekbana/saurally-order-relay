services:
  saurally-order-relay:
    image: golang:1.22-alpine
    container_name: saurally-order-relay

    restart: unless-stopped

    working_dir: /app

    env_file:
      - .env

    # Port mapping: TrueNAS 5555 â†’ container 8080
    ports:
      - "5555:8080"

    volumes:
      # Source code
      - /mnt/SSD256/configs/saurally-order-relay:/app

      # Persistent data & logs
      - /mnt/SSD256/configs/saurally-order-relay:/data

    command: >
      sh -c "
      go mod init saurally-order-relay 2>/dev/null || true &&
      go mod tidy
